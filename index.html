<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2024æ†²é‚£8 ç¸½çµ±å½ˆåŠ¾æ¡ˆ - æ™ºæ…§é–±è®€å™¨</title>
    
    <!-- å­—é«” -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;500;700&family=Noto+Sans+TC:wght@300;400;500&display=swap" rel="stylesheet">
    
    <!-- Markmap (å¿ƒæ™ºåœ–å‡½å¼åº«) -->
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/markmap-view@0.15.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/markmap-lib@0.15.4/dist/browser/index.min.js"></script>

    <style>
        :root {
            --bg-color: #f9f9f7;
            --text-color: #2c2c2c;
            --sidebar-bg: #1f2023;
            --sidebar-text: #e0e0e0;
            --accent-color: #b83b3b; /* æ¬Šå¨ç´… */
            --accent-hover: #962d2d;
            --secondary-color: #4a6fa5; /* ç§‘æŠ€è—ï¼Œç”¨æ–¼åŠŸèƒ½æŒ‰éˆ• */
            --border-color: #e0e0e0;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Noto Serif TC', serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- å´é‚Šæ¬„ --- */
        #sidebar {
            width: 320px;
            background-color: var(--sidebar-bg);
            color: var(--sidebar-text);
            display: flex;
            flex-direction: column;
            border-right: 1px solid #333;
            z-index: 1000;
            transition: transform 0.3s ease;
            box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        }

        #sidebar-header {
            padding: 20px;
            background-color: #161618;
            font-family: 'Noto Sans TC', sans-serif;
            border-bottom: 1px solid #333;
        }

        .global-map-btn {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: background 0.2s;
        }
        .global-map-btn:hover { background-color: #3b5c8d; }

        #toc {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
        }

        .toc-item {
            padding: 8px 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
            border-left: 3px solid transparent;
            text-decoration: none;
            color: #aaa;
            display: block;
            line-height: 1.4;
        }
        .toc-item:hover { color: #fff; background: rgba(255,255,255,0.05); }
        .toc-item.active { border-left-color: var(--accent-color); color: #fff; background: rgba(255,255,255,0.05); font-weight: bold; }
        
        .toc-lvl-0 { font-size: 1.05em; font-weight: 700; color: #fff; margin-top: 10px; background: #2a2a2d; }
        .toc-lvl-1 { padding-left: 30px; }
        .toc-lvl-2 { padding-left: 45px; font-size: 0.85em; }
        .toc-lvl-3 { padding-left: 60px; font-size: 0.8em; }

        /* --- ä¸»å…§å®¹å€ --- */
        #main {
            flex: 1;
            overflow-y: auto;
            position: relative;
            scroll-behavior: smooth;
        }

        #content-container {
            max-width: 850px;
            margin: 0 auto;
            padding: 60px 40px 150px 40px;
            line-height: 1.9;
            font-size: 1.15em;
            background-color: #fff;
            box-shadow: 0 0 30px rgba(0,0,0,0.03);
            min-height: 100%;
        }

        /* --- æ’ç‰ˆæ¨£å¼ --- */
        h1.doc-title { text-align: center; margin-bottom: 50px; border-bottom: 3px double #000; padding-bottom: 20px; }
        
        /* æ¨™é¡Œèˆ‡å·¥å…·åˆ—å®¹å™¨ */
        .section-wrapper {
            position: relative;
            margin-top: 3em;
            margin-bottom: 1em;
        }
        
        .section-header {
            margin: 0;
            display: inline-block;
            line-height: 1.4;
        }

        /* å·¥å…·æŒ‰éˆ• (èªéŸ³/å¿ƒæ™ºåœ–) */
        .tool-bar {
            display: inline-flex;
            gap: 8px;
            margin-left: 15px;
            vertical-align: middle;
            opacity: 0.4;
            transition: opacity 0.2s;
        }
        .section-wrapper:hover .tool-bar { opacity: 1; }

        .tool-btn {
            background: none;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            padding: 2px 8px;
            font-size: 0.7em;
            font-family: 'Noto Sans TC', sans-serif;
            color: #666;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all 0.2s;
        }
        .tool-btn:hover { background-color: #f0f0f0; color: #000; border-color: #999; }
        .tool-btn.speaking { background-color: var(--accent-color); color: white; border-color: var(--accent-color); animation: pulse 1.5s infinite; }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }

        /* å±¤ç´šæ¨£å¼ */
        .lvl-0 { text-align: center; font-size: 1.7em; font-weight: 700; border-top: 1px solid #eee; padding-top: 40px; }
        .lvl-1 { font-size: 1.4em; font-weight: 700; border-left: 5px solid var(--accent-color); padding-left: 15px; background: #fafafa; }
        .lvl-2 { font-size: 1.25em; font-weight: 600; color: #333; }
        .lvl-3 { font-size: 1.1em; font-weight: 600; color: #444; }
        .lvl-4 { font-size: 1em; font-weight: 600; font-style: italic; color: #555; }

        p { margin-bottom: 1.2em; text-align: justify; }
        
        /* è£œå……æ„è¦‹ */
        .supplementary {
            background-color: #f1f5f9;
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid #4a6fa5;
            margin: 30px 0;
            font-size: 0.95em;
        }

        /* --- æ¨¡æ…‹è¦–çª— (å¿ƒæ™ºåœ–) --- */
        #mindmap-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        #mindmap-content {
            width: 90%;
            height: 90%;
            background: white;
            border-radius: 8px;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        #mindmap-header {
            padding: 15px 20px;
            background: #f0f0f0;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Noto Sans TC', sans-serif;
        }

        #mindmap-svg-container {
            flex: 1;
            width: 100%;
            height: 100%;
        }
        
        #close-modal {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #666;
        }
        #close-modal:hover { color: #000; }

        /* --- è¼‰å…¥ç•«é¢ --- */
        #loader {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }
        .file-btn {
            padding: 12px 24px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1.1em;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* --- æ‰‹æ©Ÿç‰ˆ --- */
        #mobile-menu-btn {
            display: none;
            position: fixed;
            bottom: 20px; right: 20px;
            width: 50px; height: 50px;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            z-index: 1500;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            cursor: pointer;
        }

        @media (max-width: 768px) {
            #sidebar { position: fixed; left: -320px; height: 100%; }
            #sidebar.open { transform: translateX(320px); }
            #content-container { padding: 30px 20px; }
            #mobile-menu-btn { display: flex; }
            .tool-bar { opacity: 1; display: block; margin-left: 0; margin-top: 10px; }
            .tool-btn { display: inline-flex; padding: 6px 12px; margin-right: 5px; }
        }
    </style>
</head>
<body>

    <!-- è¼‰å…¥å±¤ -->
    <div id="loader">
        <h2 style="color: #333;">æ†²æ³•æ³•é™¢åˆ¤æ±ºæ›¸ - æ™ºæ…§é–±è®€å™¨</h2>
        <p style="color: #666; margin-bottom: 20px;">è«‹ç¢ºä¿ .txt æª”æ¡ˆèˆ‡æ­¤ç¶²é ä½æ–¼åŒä¸€è³‡æ–™å¤¾</p>
        <button class="file-btn" onclick="document.getElementById('fileInput').click()">ğŸ“‚ é–‹å•Ÿåˆ¤æ±ºæ›¸æ–‡å­—æª”</button>
        <input type="file" id="fileInput" accept=".txt" style="display:none">
        <p id="statusMsg" style="margin-top:15px; color: #888; font-size: 0.9em;"></p>
    </div>

    <!-- å´é‚Šæ¬„ -->
    <div id="sidebar">
        <div id="sidebar-header">
            <div style="font-weight: 500; font-size: 1.1em; margin-bottom: 5px;">åˆ¤æ±ºæ›¸å°èˆª</div>
            <button class="global-map-btn" onclick="showMindMap(rootNode, 'å…¨æ¡ˆç¸½è¦½')">
                <span>ğŸ§ </span> é¡¯ç¤ºç¸½å¿ƒæ™ºåœ–
            </button>
        </div>
        <div id="toc"></div>
    </div>

    <!-- æ‰‹æ©Ÿé¸å–® -->
    <div id="mobile-menu-btn">â˜°</div>

    <!-- ä¸»å…§å®¹ -->
    <div id="main">
        <div id="content-container"></div>
    </div>

    <!-- å¿ƒæ™ºåœ– Modal -->
    <div id="mindmap-modal">
        <div id="mindmap-content">
            <div id="mindmap-header">
                <span id="mindmap-title" style="font-weight:bold;">å¿ƒæ™ºåœ–</span>
                <button id="close-modal">âœ•</button>
            </div>
            <svg id="mindmap-svg-container"></svg>
        </div>
    </div>

    <script>
        const FILENAME = 'data.txt';
        let rootNode = null; // æ¨¹ç‹€çµæ§‹æ ¹ç¯€é»
        let markmapInstance = null;
        let currentUtterance = null;

        document.addEventListener('DOMContentLoaded', () => {
            // å˜—è©¦è‡ªå‹•è®€å–
            fetch(FILENAME)
                .then(res => {
                    if(!res.ok) throw new Error();
                    return res.text();
                })
                .then(text => initApp(text))
                .catch(() => {
                    document.getElementById('statusMsg').innerText = "ç„¡æ³•è‡ªå‹•è¼‰å…¥ï¼Œè«‹æ‰‹å‹•é¸æ“‡æª”æ¡ˆã€‚";
                });

            // æ‰‹å‹•é¸æ“‡
            document.getElementById('fileInput').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (ev) => initApp(ev.target.result);
                reader.readAsText(file);
            });

            // æ‰‹æ©Ÿé¸å–®
            const sidebar = document.getElementById('sidebar');
            const toggle = document.getElementById('mobile-menu-btn');
            toggle.addEventListener('click', () => {
                sidebar.classList.toggle('open');
                toggle.innerText = sidebar.classList.contains('open') ? 'âœ•' : 'â˜°';
            });

            // é—œé–‰ Modal
            document.getElementById('close-modal').addEventListener('click', () => {
                document.getElementById('mindmap-modal').style.display = 'none';
                // æ¸…ç©º SVG ä»¥å…ä¸‹æ¬¡é‡ç¹ªæ®˜ç•™
                document.getElementById('mindmap-svg-container').innerHTML = '';
            });
        });

        function initApp(text) {
            document.getElementById('loader').style.display = 'none';
            rootNode = parseTextToTree(text);
            renderContent(rootNode);
            renderToc(rootNode);
        }

        // --- æ ¸å¿ƒï¼šè§£ææ–‡å­—ç‚ºæ¨¹ç‹€çµæ§‹ ---
        function parseTextToTree(text) {
            const lines = text.split('\n');
            // å®šç¾©è™›æ“¬æ ¹ç¯€é»
            const root = { id: 'root', title: 'åˆ¤æ±ºæ›¸å…¨æ–‡', level: -1, content: [], children: [] };
            let stack = [root];
            
            // ç”¨ä¾†è¾¨è­˜å±¤ç´šçš„æ­£å‰‡
            const patterns = [
                { regex: /^(ä¸»\s*æ–‡|ç†\s*ç”±)$/, level: 0 },
                { regex: /^(\d+)\.\s+(.+)$/, level: 1 }, // 1. äº‹ä»¶æ¦‚è¦
                { regex: /^([ç”²ä¹™ä¸™ä¸æˆŠå·±åºšè¾›])\.\s+(.+)$/, level: 2 }, // ç”². 
                { regex: /^\((\d+)\)\s+(.+)$/, level: 3 }, // (1)
                { regex: /^([A-Z])\)\s+(.+)$/, level: 4 }  // A)
            ];

            let headerBuffer = [];
            let inHeader = true;

            lines.forEach(line => {
                const trimmed = line.trim();
                if(!trimmed) return;

                // è™•ç†é–‹é ­çš„å…ƒæ•¸æ“š (ç›´åˆ°é‡åˆ° "ä¸»æ–‡")
                if(inHeader) {
                    if(trimmed.replace(/\s/g,'') === 'ä¸»æ–‡') {
                        inHeader = false;
                        // æŠŠ Header è³‡è¨Šç•¶ä½œç‰¹æ®Šå€å¡Šæ”¾å…¥
                        const headerNode = {
                            id: 'header-info',
                            title: 'åŸºæœ¬è³‡æ–™',
                            level: 0,
                            content: headerBuffer,
                            children: []
                        };
                        root.children.push(headerNode);
                    } else {
                        headerBuffer.push(trimmed);
                        return;
                    }
                }

                // åˆ¤æ–·æ˜¯å¦ç‚ºæ¨™é¡Œ
                let matchLevel = -1;
                let titleText = '';

                for(let p of patterns) {
                    const m = trimmed.match(p.regex);
                    if(m) {
                        matchLevel = p.level;
                        titleText = (p.level === 0) ? trimmed.replace(/\s/g,'') : (m[2] || m[1]); // ä¸»æ–‡/ç†ç”±ç”¨å…¨å
                        if(p.level === 1) titleText = m[0]; // 1. ... ä¿ç•™ç·¨è™Ÿ
                        if(p.level === 2) titleText = m[0];
                        if(p.level === 3) titleText = m[0];
                        break;
                    }
                }

                if (matchLevel !== -1) {
                    // æ‰¾åˆ°æ¨™é¡Œï¼Œå»ºç«‹æ–°ç¯€é»
                    const newNode = {
                        id: 'sec-' + Math.random().toString(36).substr(2, 9),
                        title: titleText,
                        level: matchLevel,
                        content: [],
                        children: []
                    };

                    // èª¿æ•´ Stackï¼šå½ˆå‡ºæ¯”ç•¶å‰å±¤ç´šæ·±æˆ–ç›¸ç­‰çš„ç¯€é»ï¼Œæ‰¾åˆ°çˆ¶ç¯€é»
                    while(stack.length > 1 && stack[stack.length-1].level >= matchLevel) {
                        stack.pop();
                    }
                    stack[stack.length-1].children.push(newNode);
                    stack.push(newNode);
                } else {
                    // æ™®é€šå…§æ–‡ï¼ŒåŠ å…¥ç•¶å‰ç¯€é»
                    stack[stack.length-1].content.push(trimmed);
                }
            });

            return root;
        }

        // --- æ¸²æŸ“ HTML å…§å®¹ ---
        function renderContent(node) {
            const container = document.getElementById('content-container');
            let html = '';

            // éè¿´æ¸²æŸ“
            function traverse(n) {
                // å¿½ç•¥ root æœ¬èº«ï¼Œåªæ¸²æŸ“å­ç¯€é»
                if(n.id === 'root') {
                    html += `<h1 class="doc-title">2024æ†²é‚£8 ç¸½çµ±ï¼ˆå°¹éŒ«æ‚…ï¼‰å½ˆåŠ¾</h1>`;
                    if(n.children) n.children.forEach(c => traverse(c));
                    return;
                }

                // Header ç‰¹æ®Šè™•ç†
                if(n.id === 'header-info') {
                    html += `<div style="text-align:right; color:#555; font-size:0.9em; margin-bottom:40px;">
                        ${n.content.map(l => `<div>${l}</div>`).join('')}
                    </div>`;
                    return;
                }

                // æ¨™é¡Œå€å¡Š
                const isSupplement = n.title.includes('è£œå……æ„è¦‹');
                if(isSupplement) html += `<div class="supplementary">`;

                html += `<div class="section-wrapper" id="wrap-${n.id}">`;
                
                // æ¨™é¡Œ + å·¥å…·åˆ—
                html += `<h${n.level + 2} id="${n.id}" class="section-header lvl-${n.level}">
                            ${n.title}
                         </h${n.level + 2}>
                        `;
                
                // å·¥å…·æŒ‰éˆ• (åªåœ¨æœ‰æ¨™é¡Œçš„ç¯€é»é¡¯ç¤º)
                html += `<div class="tool-bar">
                            <button class="tool-btn" onclick="playAudio('${n.id}')" id="btn-play-${n.id}">
                                ğŸ”Š æœ—è®€
                            </button>
                            <button class="tool-btn" onclick="showMindMapById('${n.id}')">
                                ğŸ§  å¿ƒæ™ºåœ–
                            </button>
                         </div>`;
                
                html += `</div>`; // end wrapper

                // å…§æ–‡æ®µè½
                if(n.content.length > 0) {
                    html += `<div class="section-content">`;
                    n.content.forEach(p => {
                        html += `<p>${p}</p>`;
                    });
                    html += `</div>`;
                }

                // å­ç¯€é»
                if(n.children && n.children.length > 0) {
                    n.children.forEach(c => traverse(c));
                }

                if(isSupplement) html += `</div>`;
            }

            traverse(node);
            container.innerHTML = html;
        }

        // --- æ¸²æŸ“ç›®éŒ„ (TOC) ---
        function renderToc(node) {
            const tocDiv = document.getElementById('toc');
            let html = '';

            function traverse(n) {
                if(n.id !== 'root' && n.id !== 'header-info') {
                    // é™åˆ¶é•·åº¦
                    let label = n.title.length > 18 ? n.title.substring(0, 18) + '...' : n.title;
                    html += `<a href="#${n.id}" class="toc-item toc-lvl-${n.level}">${label}</a>`;
                }
                if(n.children) n.children.forEach(c => traverse(c));
            }
            traverse(node);
            tocDiv.innerHTML = html;
        }

        // --- åŠŸèƒ½ 1: èªéŸ³æœ—è®€ (TTS) ---
        function playAudio(nodeId) {
            const btn = document.getElementById(`btn-play-${nodeId}`);
            
            // å¦‚æœæ­£åœ¨æœ—è®€ï¼Œå‰‡åœæ­¢
            if(window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
                document.querySelectorAll('.tool-btn').forEach(b => {
                    b.classList.remove('speaking');
                    if(b.innerText.includes('åœæ­¢')) b.innerHTML = 'ğŸ”Š æœ—è®€';
                });
                // å¦‚æœé»æ“Šçš„æ˜¯åŒä¸€å€‹æŒ‰éˆ•ï¼Œå°±åœåœ¨é€™è£¡
                if(btn.dataset.speaking === 'true') {
                    btn.dataset.speaking = 'false';
                    return;
                }
            }

            // å°‹æ‰¾ç¯€é»è³‡æ–™
            const targetNode = findNodeById(rootNode, nodeId);
            if(!targetNode) return;

            // æ§‹å»ºæœ—è®€æ–‡æœ¬ï¼šæ¨™é¡Œ + ç›´æ¥å…§æ–‡ (ä¸åŒ…å«å­ç¯€é»ï¼Œé¿å…å¤ªé•·)
            let textToRead = targetNode.title + ".\n" + targetNode.content.join(".\n");
            
            // å¦‚æœå…§å®¹å¤ªå°‘ï¼Œä¸”æœ‰å­ç¯€é»ï¼Œé †ä¾¿è®€å­ç¯€é»çš„æ¨™é¡Œ
            if(targetNode.content.length === 0 && targetNode.children.length > 0) {
                textToRead += "åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š";
                targetNode.children.forEach(c => textToRead += c.title + "ï¼Œ");
            }

            const utterance = new SpeechSynthesisUtterance(textToRead);
            utterance.lang = 'zh-TW';
            utterance.rate = 1.0;

            utterance.onstart = () => {
                btn.classList.add('speaking');
                btn.innerHTML = 'â¹ åœæ­¢';
                btn.dataset.speaking = 'true';
            };
            utterance.onend = () => {
                btn.classList.remove('speaking');
                btn.innerHTML = 'ğŸ”Š æœ—è®€';
                btn.dataset.speaking = 'false';
            };

            window.speechSynthesis.speak(utterance);
        }

        // --- åŠŸèƒ½ 2: å¿ƒæ™ºåœ– (Markmap) ---
        function showMindMapById(nodeId) {
            const targetNode = findNodeById(rootNode, nodeId);
            if(targetNode) showMindMap(targetNode, targetNode.title);
        }

        function showMindMap(dataNode, title) {
            document.getElementById('mindmap-modal').style.display = 'flex';
            document.getElementById('mindmap-title').innerText = title + " - å¿ƒæ™ºåœ–";
            
            // è½‰æ›è³‡æ–™æ ¼å¼ç‚º Markmap Markdown æ ¼å¼
            const markdown = convertNodeToMarkdown(dataNode);
            
            // æ¸²æŸ“
            const svgEl = document.getElementById('mindmap-svg-container');
            svgEl.innerHTML = ''; // æ¸…ç©º
            
            const { Markmap, Transformer } = window.markmap;
            const transformer = new Transformer();
            const { root, features } = transformer.transform(markdown);
            
            Markmap.create(svgEl, null, root);
        }

        // å°‡æ¨¹ç‹€çµæ§‹è½‰ç‚º Markmap æ”¯æ´çš„ Markdown æ ¼å¼ (#, ##, -) 
        function convertNodeToMarkdown(node, depth = 1) {
            let md = "";
            // å¦‚æœæ˜¯ Root å‚³å…¥ï¼Œåªå–å…¶ Title
            if(depth === 1) {
                md += `# ${node.title}\n`;
            } else {
                // æ ¹æ“šæ·±åº¦æ±ºå®šå±¤ç´š
            }

            // è™•ç†å­ç¯€é»
            if(node.children && node.children.length > 0) {
                node.children.forEach(child => {
                    md += recursiveMarkdown(child, 0);
                });
            } else {
                // è‘‰ç¯€é»ï¼šå˜—è©¦æŠŠå…§æ–‡è®Šæˆå­é …ç›®ï¼Œé¿å…åªæœ‰æ¨™é¡Œ
                if(node.content.length > 0) {
                    node.content.slice(0, 3).forEach(p => {
                        // æ“·å–å‰å¹¾å¥ä½œç‚ºé‡é»
                        let summary = p.substring(0, 30) + (p.length>30?'...':'');
                        md += `- ${summary}\n`;
                    });
                }
            }
            return md;
        }

        function recursiveMarkdown(node, indentLevel) {
            let indent = "  ".repeat(indentLevel);
            let str = `${indent}- ${node.title}\n`;
            
            // å…§æ–‡ (é¸æ“‡æ€§é¡¯ç¤ºï¼Œé¿å…å¤ªäº‚ï¼Œåªé¡¯ç¤ºç¬¬ä¸€æ®µç°¡è¦)
            /* 
            if(node.content.length > 0) {
                let p = node.content[0];
                let summary = p.length > 20 ? p.substring(0, 20) + "..." : p;
                str += `${indent}  - <small>${summary}</small>\n`;
            }
            */

            if(node.children) {
                node.children.forEach(c => {
                    str += recursiveMarkdown(c, indentLevel + 1);
                });
            }
            return str;
        }

        // --- è¼”åŠ©å‡½å¼ ---
        function findNodeById(node, id) {
            if(node.id === id) return node;
            if(node.children) {
                for(let c of node.children) {
                    const found = findNodeById(c, id);
                    if(found) return found;
                }
            }
            return null;
        }

    </script>
</body>
</html>